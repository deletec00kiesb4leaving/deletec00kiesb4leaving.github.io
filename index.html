<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coder's Terminal</title>
    <style>
        body {
            background: #1d1e20;
            color: #87CEEB;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            overflow: hidden;
        }
        
        #terminal {
            max-width: 800px;
            margin: 0 auto;
            min-height: 400px;
        }
        
        .blink {
            animation: blink 1s step-end infinite;
        }
        
        @keyframes blink {
            50% { opacity: 0; }
        }
        
        .prompt {
            color: #87CEEB;
        }
        
        .command {
            color: #FFFFFF;
        }
        
        #input-line {
            display: flex;
            align-items: center;
        }
        
        #input {
            background: none;
            border: none;
            color: #FFFFFF;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            outline: none;
            width: 100%;
        }
        
        a {
            color: #87CEEB;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }

        ul {
            list-style-type: none;
            padding-left: 20px;
        }

        .hidden {
            display: none;
        }

        .disabled {
            pointer-events: none;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="output">
            <p>Welcome to the Coding Terminal. Type 'help' to start.</p>
        </div>
        <div id="input-line">
            <span class="prompt">user@code:~$ </span>
            <input type="text" id="input" autofocus>
        </div>
    </div>

    <script>
        // Command definitions
        const commands = {
            'help': 'Available commands: clear, top',
            'clear': '',
            'top': ''
        };

        // Process data from the image
        const processes = [
            { pid: '1001', command: 'Python', port: '8080', cpu: '15.2', mem: '5.1', time: '12:34', state: 'R' },
            { pid: '1002', command: 'Java+Script', port: '3000', cpu: '12.8', mem: '4.9', time: '10:15', state: 'S' },
            { pid: '1003', command: 'C++', port: '5000', cpu: '8.5', mem: '3.2', time: '08:22', state: 'R' },
            { pid: '1004', command: 'Java', port: '8081', cpu: '10.1', mem: '6.0', time: '15:47', state: 'S' },
            { pid: '1005', command: 'HTML/CSS', port: '80', cpu: '5.3', mem: '2.8', time: '06:19', state: 'R' },
            { pid: '1006', command: 'SQL', port: '3306', cpu: '7.9', mem: '3.5', time: '09:33', state: 'S' },
            { pid: '1007', command: 'Git', port: '9418', cpu: '4.2', mem: '1.9', time: '04:55', state: 'S' },
            { pid: '1008', command: 'Node.js', port: '3001', cpu: '11.6', mem: '5.7', time: '11:28', state: 'R' },
            { pid: '1009', command: 'React', port: '3002', cpu: '9.4', mem: '4.7', time: '07:41', state: 'R' },
            { pid: '1010', command: 'CyberSec', port: '22', cpu: '6.7', mem: '3.0', time: '05:12', state: 'R' },
            { pid: '1011', command: 'Docker', port: '2375', cpu: '13.0', mem: '4.0', time: '14:09', state: 'S' }
        ];

        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const inputLine = document.getElementById('input-line');
        let commandHistory = [];
        let historyIndex = -1;
        let topInterval = null;

        // Function to add text to the output
        function addOutput(text) {
            if (text === '') {
                output.innerHTML = '';
                return;
            }
            const p = document.createElement('p');
            p.innerHTML = text;
            output.appendChild(p);
            window.scrollTo(0, document.body.scrollHeight);
        }

        // Function to start the top-like display
        function startTop() {
            output.innerHTML = ''; // Clear output for top
            inputLine.classList.add('hidden'); // Hide input line
            input.disabled = true; // Disable input while top is running
            input.classList.add('disabled'); // Add visual indication of being disabled

            function updateTop() {
                const now = new Date();
                const timestamp = now.toLocaleString('en-US', { hour12: false });
                const loadAvg = '1.23, 0.95, 0.87'; // Static for simplicity
                let topOutput = `top - ${timestamp} user: coder load average: ${loadAvg}<br>`;
                topOutput += 'Tasks: 11 total<br><br>';
                // Header with fixed widths
                topOutput += 'PID    COMMAND         #PORT  %CPU  %MEM  TIME     STATE<br>';
                topOutput += '<ul>';
                processes.forEach(process => {
                    // Ensure TIME is formatted consistently
                    let formattedTime = process.time.length === 5 ? `00:${process.time}` : process.time;
                    topOutput += `<li>` +
                        `${process.pid.padEnd(6)} ` +
                        `${process.command.padEnd(15)} ` +
                        `${('#' + process.port).padEnd(7)} ` +
                        `${process.cpu.padEnd(5)} ` +
                        `${process.mem.padEnd(5)} ` +
                        `${formattedTime.padEnd(8)} ` +
                        `${process.state}` +
                        `</li>`;
                });
                topOutput += '</ul><br>Press Ctrl+C to quit';
                output.innerHTML = `<p>${topOutput}</p>`;
            }
            
            updateTop(); // Initial display
            topInterval = setInterval(updateTop, 1000); // Update every second
        }

        // Handle command input
        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const command = input.value.trim().toLowerCase();
                const prompt = document.querySelector('.prompt').textContent;
                
                if (command !== '') {
                    commandHistory.unshift(command);
                    historyIndex = -1;
                }
                
                addOutput(`${prompt}${command}`);
                
                if (command in commands) {
                    if (command === 'top') {
                        startTop();
                    } else {
                        addOutput(commands[command]);
                    }
                } else if (command !== '') {
                    addOutput(`Command not found: ${command}. Type 'help' for available commands.`);
                }
                
                input.value = '';
            }
        });

        // Handle arrow keys for command history
        input.addEventListener('keydown', function(e) {
            if (!input.disabled) { // Only process keystrokes if input is enabled
                if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (commandHistory.length === 0) return;
                    
                    if (historyIndex < commandHistory.length - 1) {
                        historyIndex++;
                    }
                    input.value = commandHistory[historyIndex] || '';
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (commandHistory.length === 0) return;
                    
                    if (historyIndex > -1) {
                        historyIndex--;
                    }
                    input.value = historyIndex >= 0 ? commandHistory[historyIndex] : '';
                }
            }
        });

        // Handle Ctrl+C to exit top
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'c' && topInterval) {
                e.preventDefault(); // Prevent default Ctrl+C behavior
                clearInterval(topInterval);
                topInterval = null;
                output.innerHTML = '';
                inputLine.classList.remove('hidden'); // Show input line again
                input.disabled = false; // Re-enable input
                input.classList.remove('disabled'); // Remove disabled visual indication
                addOutput('user@code:~$ top terminated');
                input.value = ''; // Clear input field
                input.focus(); // Focus on input for next command
            }
        });

        // Focus input on click anywhere, but only if not disabled
        document.addEventListener('click', () => {
            if (!input.disabled) {
                input.focus();
            }
        });
    </script>
</body>
</html>
